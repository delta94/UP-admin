language: python
python: '3.6.5'
node_js: 8
services:
  - postgresql
before_install:
  - npm i -g npm
  - export DJANGO_SETTINGS_MODULE=up.production_settings
install:
  - pip install -r requirements.txt
  - pip install codecov
  - npm install
before_script:
  - psql -c 'create database travis_ci_test;' -U postgres
script:
  - python manage.py migrate
  - python manage.py collectstatic --noinput
  - ls
  - coverage run --omit=*/migrations/* --source=admin,api manage.py test
  #- cd frontend
  #- npm test
  #- cd ..
after_success:
  - codecov --token=711f2ba1-59bf-4dbc-95da-9d25ef91c932
notifications:
  email: false
